[cluster_hosts:children]
OSEv3

[OSEv3:children]
lb
masters
nodes
etcd
nfs

[OSEv3:vars]
openshift_release=v3.11
openshift_image_tag=v3.11.16
openshift_pkg_version=-3.11.16
openshift_version=v3.11.16
openshift_deployment_type=openshift-enterprise
openshift_master_cluster_method=native
openshift_disable_check=disk_availability,memory_availability,docker_storage,docker_image_availability
openshift_install_examples=true

# URLs
openshift_master_cluster_public_hostname=console.{{ env_id }}.{{ dns_domain }}
openshift_master_cluster_hostname=api.{{ env_id }}.{{ dns_domain }}
openshift_master_default_subdomain=apps.{{ env_id }}.{{ dns_domain }}

# HTPASSWD Identity Provider
openshift_master_identity_providers="[{'name': 'Default Authentication', 'login': 'true', 'challenge': 'true', 'kind': 'HTPasswdPasswordIdentityProvider'}]"
openshift_master_htpasswd_file='/etc/origin/master/htpasswd'

openshift_master_htpasswd_users="[{'admin': '$apr1$7aiANAYb$TOUYVUqnBqBlD5AQEIMYw1'}]"
openshift_hosted_manage_router=true
openshift_hosted_router_selector='node-role.kubernetes.io/infra=true'
openshift_router_selector='node-role.kubernetes.io/infra=true'
osm_default_node_selector='node-role.kubernetes.io/compute=true'
openshift_docker_options="--log-driver=json-file --log-opt max-size=50m --log-opt max-file=100"

# Storage
# We're using NFS (first pass) so we have to enable unsupported configs
# Our NFS share has 50Gi available, we're going to allocate 10 for the registry
# which gives us enough to toy with different PVs later
#
# TODO=Swap this out for a OCS-3.11 config using Gluster
#
openshift_enable_unsupported_configurations=true
openshift_hosted_registry_storage_kind=nfs
openshift_hosted_registry_storage_host=support1.a935.internal
openshift_hosted_registry_storage_access_modes="['ReadWriteMany']"
openshift_hosted_registry_storage_nfs_directory=/srv/nfs/
openshift_hosted_registry_storage_nfs_options='*(rw,root_squash,no_wdelay,sync)'
openshift_hosted_registry_storage_volume_name=registry
openshift_hosted_registry_storage_volume_size=10Gi
openshift_hosted_registry_selector='node-role.kubernetes.io/infra=true'

# Networking
os_sdn_network_plugin_name='redhat/openshift-ovs-networkpolicy'
os_firewall_use_firewalld=true
osm_cluster_network_cidr=10.1.0.0/16
openshift_master_console_port=443
openshift_master_api_port=443

# Registry URL & Credentials
system_images_registry='registry.redhat.io'
oreg_url='registry.redhat.io/openshift3/ose-${component}:${version}'
oreg_auth_user="{{ lookup('env', 'OREG_AUTH_USER' )}}"
oreg_auth_password="{{ lookup('env', 'OREG_AUTH_PASSWORD' )}}"

# Metrics
openshift_hosted_prometheus_deploy=false
openshift_cfme_install_app=false

#
# Group and Host-specific vars
#

[all:vars]
env_id=a935
ansible_user=ec2-user
ansible_become=true
dns_domain="example.opentlc.com"
rhsm_register=True
rhsm_repos="['rhel-7-server-rpms', 'rhel-7-server-ose-3.11-rpms', 'rhel-7-server-extras-rpms', 'rhel-7-server-ansible-2.6-rpms']"
rhsm_username="{{ lookup('env', 'RHSM_USER' )}}"
rhsm_password="{{ lookup('env', 'RHSM_PASSWD' )}}"

[nodes:vars]
docker_storage_block_device="/dev/xvdb"
docker_storage_mount_point="/var/lib/containers/docker"
# Subscription Management Details
docker_version="1.13.1"
openshift_docker_service_name='docker'

[masters]
master[1:3].a935.internal

[masters:vars]
ansible_ssh_host="{{ inventory_hostname.split('.')[0] }}.a935.internal"
openshift_hostname="{{ ansible_ssh_host }}"
openshift_node_group_name='node-config-master'
openshift_node_labels="['node-role.kubernetes.io/master=true']"
openshift_node_open_ports="[{'service': 'prometheus node exporter', 'port': '9100/tcp'}]"

[etcd]
master[1:3].a935.internal

[nodes:children]
masters
infra_hosts
app_hosts

[infra_hosts]
infranode[1:2].a935.internal 

[infra_hosts:vars]
ansible_ssh_host="{{ inventory_hostname.split('.')[0] }}.a935.internal"
openshift_hostname="{{ ansible_ssh_host }}"
openshift_node_group_name='node-config-infra'
openshift_node_labels="['node-role.kubernetes.io/infra=true']"
openshift_node_open_ports="[{'service': 'prometheus node exporter', 'port': '9100/tcp'}]"

[app_hosts]
node[1:4].a935.internal

[app_hosts:vars]
ansible_ssh_host="{{ inventory_hostname.split('.')[0] }}.a935.internal"
openshift_hostname="{{ ansible_ssh_host }}"
openshift_node_group_name='node-config-compute'
openshift_node_labels="['node-role.kubernetes.io/compute=true']"
openshift_node_open_ports="[{'service': 'prometheus node exporter', 'port': '9100/tcp'}]"

[nfs]
support1.a935.internal

[lb]
loadbalancer1.a935.internal 
